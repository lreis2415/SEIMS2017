<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<title>SEIMS: 参数敏感性分析</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygenextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="topbanner"><a href="https://github.com/lreis2415/SEIMS" title="SEIMS GitHub"><i class="githublogo"></i></a></div>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'搜索','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('getstart_parameters_sensitivity.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">参数敏感性分析 </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>目录</h3>
<ul><li class="level1"><a href="#autotoc_md61">简单用法</a></li>
<li class="level1"><a href="#autotoc_md62">参数敏感性分析的配置文件</a></li>
<li class="level1"><a href="#autotoc_md63">高级用法</a></li>
<li class="level1"><a href="#autotoc_md64">更多介绍...</a></li>
</ul>
</div>
<div class="textblock"><p ><a class="anchor" id="md_doc_zh_cn_get_started_parameters_sensitivity"></a></p>
<p >参数敏感性分析对于确定指定模拟目标（例如流域出口的流量）最重要或最有影响的参数非常有用（Zhan et al., 2013）。典型的敏感性分析流程包括从确定的模型输入值范围中取样、用生成的样本对模型进行评估并保存感兴趣的输出，以及通过各种方法计算敏感性指数，如Morris筛选方法（Morris, 1991）和FAST方法（Fourier Amplitude Sensitivity Test, Cukier et al., 1978）。SEIMS中的敏感性分析工具按照这些步骤组织为独立的功能模块，因此可以轻松集成任何采样方法和敏感性分析方法。最耗时的步骤是重复的模型评估，SEIMS使用基于SCOOP的并行工作管理（Hold-Geoffroy et al., 2014），在模型层次实现并行化。</p>
<h1><a class="anchor" id="autotoc_md61"></a>
简单用法</h1>
<p >打开一个CMD窗口，输入以下命令执行游屋圳流域模型的预定义参数敏感性分析：</p>
<div class="fragment"><div class="line">cd D:\demo\SEIMS\seims\test</div>
<div class="line">D:</div>
<div class="line">python –m scoop –n 2 demo_parameters_sensitivity.py -name youwuzhen</div>
</div><!-- fragment --><p >运行日志包括每次模型运行的命令和敏感性分析结果，如图 2:6 1所示。</p>
<p >首先，选定参数的采样率定值组织为浮点数组，并作为 <code>CALI_VALUES</code>字段导入主空间数据库的<code>PARAMETERS</code> 集合中。通过将 <code>calibrationID</code>设置为对应数组索引（从0开始），可以评估基于SEIMS的流域模型在一组率定参数下的表现（图 2:6 1a）。可以通过以下命令在Robo 3T的控制台窗口中查询率定值（图 2:6 2）。</p>
<div class="fragment"><div class="line">db.getCollection(&#39;PARAMETERS&#39;).find({&#39;CALI_VALUES&#39;:{$exists:true}})</div>
</div><!-- fragment --><p >然后，基于SCOOP的工作线程数，对所有组合的率定参数进行并行评估。例如，在简单用法中分配了2个线程（-m scoop –n 2）。在每个率定模型评估完成后，将计算感兴趣的模型性能指标并保存。当前版本的SEIMS中，NSE（Nash-Sutcliffe 效率）、RSR（均方根误差-标准差比）、PBIAS（偏差百分比）（Moriasi et al., 2007）被用作模型性能指标。 最终，根据上述模型输出执行敏感性分析方法（此例中为Morris筛选方法）。例如，图 2:6 3展示了流域出口模拟流量（m3s-1）NSE指标对应的参数敏感性分析结果。筛选图中的每个点代表游屋圳流域模型的一个参数。修改后的均值μ*值越大（Campolongo et al., 2007），流域对参数变化的响应越敏感（Yang, 2011; Zhan et al., 2013）。更多结果可在输出目录中找到，例如：<code>SEIMS\data\youwuzhen\demo_youwuzhen30m_longterm_model\PSA_Morris_N4L2</code>。</p>
<h1><a class="anchor" id="autotoc_md62"></a>
参数敏感性分析的配置文件</h1>
<p >另请参阅Python包的介绍 <a class="el" href="intro_parameters_sensitivity_pkg.html">seims.parameters_sensitivity package</a></p>
<p >参数敏感性分析的配置文件（如图 2:6 4所示的游屋圳流域模型配置文件）包括四个部分：SEIMS_Model、PARAMETERS、OPTIONAL_PARAMETERS 和 OPTIONAL_MATPLOT_SETTING。其中，OPTIONAL_PARAMETERS 和 OPTIONAL_MATPLOT_SETTING是可选的。section和选项的名称不能更改。</p>
<ul>
<li>SEIMS_Model: 基于SEIMS流域模型的基本设置，详情参见章节 2:4.3.2。注意默认使用SEIMS主程序的OpenMP版本。如果需要MPI&amp;OpenMP版本，可以配置version、MPI_BIN 和 processNum等选项。</li>
<li>PSA_PARAMETERS: 参数敏感性分析的基本设置。<ol type="1">
<li>evaluateParam: 待评估的模拟目标，如流量（Q）、泥沙（SED）和总氮（CH_TN）。此选项与章节 2:5.2后处理中的PLOT_VARIABLES类似。多个参数用逗号分隔。</li>
<li>paramRngDef: 定义参数范围的文件名。该文件遵循SEIMS的基本纯文本文件格式。每行表示一个待分析参数，格式为：NAME, lower_bound, upper_bound。例如：K_pet,-0.3,0.3表示参数K_pet的影响范围为-0.3 到 0.3，影响类型与PARAMETERS集合中的定义一致。相关信息请参见章节 2:4.2.3。</li>
<li>PSA_Time_start: 敏感性分析中模型性能计算的起始时间，格式为 YYYY-MM-DD HH:MM:SS。</li>
<li>PSA_Time_end: 敏感性分析中模型性能计算的结束时间，格式为 YYYY-MM-DD HH:MM:SS。</li>
</ol>
</li>
<li>支持 SALib 的特定敏感性分析方法部分。目前，已集成并测试了Morris筛选方法，包括分组和最有轨迹（Morris_Method）以及Fourier幅度敏感性测试（FAST_Method）。在SEIMS的未来版本中，将集成更多的方法，且不限于SALib提供的方法。<ol type="1">
<li>Morris_Method: N: 生成的轨迹数。 num_levels: 网格层次的数目。生成的样本行数为(D+1)*N，列数为D，其中D是参数数目。 optimal_trajectories: 采样的最优轨迹数（范围为2至N），也可以设置为None。 local_optimization: 是否使用局部优化。对于较大的N和num_levels，开启此选项可以显著加速。如果设置为False，则使用暴力法。</li>
<li>FAST_Method: N: 生成的样本数。 M: 干扰参数，即 Fourier 系列分解中求和的谐波数，默认值为 4。</li>
</ol>
</li>
<li>OPTIONAL_MATPLOT_SETTINGS: matplotlib的绘图设置，参见章节 2:5.2。</li>
</ul>
<div class="fragment"><div class="line">[SEIMS_Model] </div>
<div class="line">MODEL_DIR = D:\demo\SEIMS\data\youwuzhen\demo_youwuzhen30m_longterm_model</div>
<div class="line">BIN_DIR = D:\demo\SEIMS\bin</div>
<div class="line">HOSTNAME = 127.0.0.1</div>
<div class="line">PORT = 27017</div>
<div class="line">threadsNum = 2</div>
<div class="line">layeringMethod = 1</div>
<div class="line">scenarioID = 0</div>
<div class="line"># Simulation period (UTCTIME)</div>
<div class="line">Sim_Time_start = 2012-01-01 00:00:00</div>
<div class="line">Sim_Time_end = 2012-03-09 23:59:59</div>
<div class="line"> </div>
<div class="line">[PSA_Settings]</div>
<div class="line">evaluateParam = Q</div>
<div class="line">paramRngDef = morris_param_rng-Q.def</div>
<div class="line"># Objective calculation period (UTCTIME)</div>
<div class="line">PSA_Time_start = 2012-02-27 00:00:00</div>
<div class="line">PSA_Time_end = 2012-03-09 23:59:59</div>
<div class="line"> </div>
<div class="line">[Morris_Method]</div>
<div class="line">N = 4</div>
<div class="line">num_levels = 2</div>
<div class="line">optimal_trajectories = None</div>
<div class="line">local_optimization = True</div>
<div class="line"> </div>
<div class="line">[OPTIONAL_MATPLOT_SETTINGS]</div>
<div class="line">FIGURE_FORMATS = PDF,PNG</div>
<div class="line">FONT_TITLE = Times New Roman</div>
<div class="line">DPI = 300</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md63"></a>
高级用法</h1>
<p >参数敏感性分析的Python脚本位于<code>SEIMS/seims/parameters_sensitivity</code>文件夹中，<code>main.py</code>是入口脚本，可以通过SEIMS Python脚本的统一格式运行，例如，</p>
<div class="fragment"><div class="line">cd D:\demo\SEIMS\seims\parameters_sensitivity</div>
<div class="line">python main.py -ini D:\demo\SEIMS\data\youwuzhen\workspace\sensitivity_analysis.ini</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md64"></a>
更多介绍...</h1>
<p >Also see introduction of the Python package <a class="el" href="intro_parameters_sensitivity_pkg.html">seims.parameters_sensitivity package</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
  </ul>
</div>
</body>
</html>
